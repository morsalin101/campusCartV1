<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Categories Dashboard - FreshCart</title>
	<link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon/favicon.ico">
	<link href="../assets/libs/bootstrap-icons/font/bootstrap-icons.min.css" rel="stylesheet">
	<link href="../assets/libs/feather-webfont/dist/feather-icons.css" rel="stylesheet">
	<link href="../assets/libs/simplebar/dist/simplebar.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../assets/css/theme.min.css">
</head>

<body>
	<!-- Navbar -->
	<div th:replace="fragments/Nav :: admin_nav"></div>

	<!-- Sidebar -->
	<div class="main-wrapper">
		<div th:replace="fragments/Sidebar :: sidebar"></div>

		<!-- Main -->
		<main class="main-content-wrapper">
			<div class="container">
				<!-- Header -->
				<div class="row mb-4">
					<div class="col-md-12 d-flex justify-content-between align-items-center">
						<h2>Categories</h2>
						<a th:href="@{/dashboard/add_category}" class="btn btn-primary">Add New Category</a>
					</div>
				</div>

				<!-- Table -->
				<div class="card card-lg">
					<div class="card-body p-0">
						<div class="table-responsive">
							<table class="table table-centered table-hover text-nowrap table-borderless mb-0">
								<thead class="bg-light">
									<tr>
										<th>Category ID</th>
										<th>Name</th>
										<th>Actions</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="category, stat : ${categories}">
										<td th:text="${stat.index + 1}">1</td>
										<td th:text="${category.name}">Category Name</td>
										<td>
											<div class="d-flex gap-2">
												<!-- Edit Button -->
												<button type="button" class="btn btn-sm btn-outline-primary"
													data-bs-toggle="modal" data-bs-target="#editModal"
													th:attr="data-id=${category.id}, data-name=${category.name}">
													<i class="bi bi-pencil-square me-1"></i>Edit
												</button>

												<!-- Delete Form -->
												<form th:action="@{/delete/{id}(id=${category.id})}" method="post">
													<button type="button" class="btn btn-sm btn-outline-danger"
														onclick="if(confirm('Are you sure you want to delete this item?')) { this.closest('form').submit(); }">
														<i class="bi bi-trash me-1"></i>Delete
													</button>

												</form>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>

					<!-- Pagination (optional) -->
					<div class="border-top px-6 py-4 d-flex justify-content-between">
						<span>Showing 1 to 8 of 12 entries</span>
						<nav>
							<ul class="pagination mb-0">
								<li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
								<li class="page-item"><a class="page-link active" href="#">1</a></li>
								<li class="page-item"><a class="page-link" href="#">2</a></li>
								<li class="page-item"><a class="page-link" href="#">Next</a></li>
							</ul>
						</nav>
					</div>
				</div>

				<!-- Modal for Edit Category -->
				<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel"
					aria-hidden="true">
					<div class="modal-dialog">
						<form th:action="@{/update}" method="post">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="editModalLabel">Edit Category</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="modal-body">
									<input type="hidden" name="id" id="edit-id">
									<div class="mb-3">
										<label for="edit-name" class="form-label">Category Name</label>
										<input type="text" class="form-control" name="name" id="edit-name" required>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Cancel</button>
									<button type="submit" class="btn btn-success">Update</button>
								</div>
							</div>
						</form>
					</div>
				</div>

			</div>
		</main>
	</div>

	<!-- Scripts -->
	<div th:replace="fragments/Script :: script"></div>
	<script>
		const editModal = document.getElementById('editModal');
		editModal.addEventListener('show.bs.modal', function (event) {
			const button = event.relatedTarget;
			const id = button.getAttribute('data-id');
			const name = button.getAttribute('data-name');
			document.getElementById('edit-id').value = id;
			document.getElementById('edit-name').value = name;
		});
	</script>
</body>

</html>