<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>Order List - CampusCart</title>
  <link rel="stylesheet" href="../assets/css/theme.min.css" />
  <link href="../assets/libs/bootstrap-icons/font/bootstrap-icons.min.css" rel="stylesheet" />
  <link href="../assets/libs/feather-webfont/dist/feather-icons.css" rel="stylesheet" />
  <link href="../assets/libs/simplebar/dist/simplebar.min.css" rel="stylesheet" />
</head>

<body>
  <!-- navbar -->
  <div th:replace="fragments/Nav :: admin_nav"></div>

  <div class="main-wrapper">
    <!-- sidebar -->
    <div th:replace="fragments/sidebar :: sidebar"></div>

    <!-- main content -->
    <main class="main-content-wrapper">
      <div class="container">
        <div class="row mb-8">
          <div class="col-md-12">
            <h2>Order List</h2>
          </div>
        </div>

        <div class="row">
          <div class="col-xl-12 col-12 mb-5">
            <div class="card h-100 card-lg">
              <div class="p-6">
                <div class="row justify-content-between">
                  <div class="col-md-4">
                    <form class="d-flex" th:action="@{/admin/orders/search}" method="get">
                      <input class="form-control" type="search" name="query" placeholder="Search..." />
                    </form>
                  </div>
                  <div class="col-md-3">
                    <select class="form-select" th:name="status">
                      <option value="">All Status</option>
                      <option value="SUCCESS">Success</option>
                      <option value="PENDING">Pending</option>
                      <option value="CANCEL">Cancel</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="table table-centered table-hover text-nowrap table-borderless mb-0 table-with-checkbox">
                    <thead class="bg-light">
                      <tr>
                        <th><input class="form-check-input" type="checkbox" id="checkAll" /></th>
                        <th>Order ID</th>
                        <th>Order Date</th>
                        <th>Customer</th>
                        <th>Payment Method</th>
                        <th>Status</th>
                        <th>Amount</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr th:each="order : ${orders}">
                        <td><input class="form-check-input" type="checkbox" th:id="'order' + ${order.id}" /></td>
                        <td>
                          <a th:href="@{'/admin/orders/details?id=' + ${order.id}}" class="text-reset fw-bold"
                            th:text="'ORD#' + ${order.id}">ORD#1</a>
                        </td>
                        <td th:text="${#dates.format(order.orderDate, 'dd MMM yyyy (hh:mm a)')}">01 Jan 2024</td>
                        <td th:text="${order.user != null ? order.user.firstName + ' ' + order.user.lastName : 'N/A'}">
                          John Doe
                        </td>
                        <td th:text="${order.payment != null ? order.payment.type : 'N/A'}">Cash</td>
                        <td>
                          <span th:classappend="'badge ' + (
                             ${order.orderStatus} == 'SUCCESS' ? 'bg-light-success text-success' :
                             ${order.orderStatus} == 'PENDING' ? 'bg-light-warning text-warning' :
                             'bg-light-danger text-danger')" th:text="${order.orderStatus}">
                            PENDING
                          </span>
                        </td>
                        <td th:text="'$' + ${#numbers.formatDecimal(order.orderTotal, 1, 'COMMA', 2, 'POINT')}">0.00
                        </td>
                        <td>
                          <div class="dropdown">
                            <a href="#" class="text-reset" data-bs-toggle="dropdown"><i
                                class="feather-icon icon-more-vertical fs-5"></i></a>
                            <ul class="dropdown-menu">
                              <li>
                                <a class="dropdown-item" th:href="@{'/admin/orders/details?id=' + ${order.id}}">
                                  <i class="bi bi-eye me-2"></i>View Details
                                </a>
                              </li>
                              <li>
                                <a class="dropdown-item" th:href="@{'/admin/orders/edit/' + ${order.id}}">
                                  <i class="bi bi-pencil-square me-2"></i>Edit
                                </a>
                              </li>
                              <li>
                                <a class="dropdown-item text-danger" th:href="@{'/admin/orders/delete/' + ${order.id}}"
                                  onclick="return confirm('Are you sure you want to delete this order?');">
                                  <i class="bi bi-trash me-2"></i>Delete
                                </a>
                              </li>
                            </ul>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Pagination -->
              <div class="border-top d-md-flex justify-content-between align-items-center p-6">
                <span th:text="'Showing ' + ${page.start} + ' to ' + ${page.end} + ' of ' + ${page.total} + ' entries'">
                  Showing 1 to 10 of 100 entries
                </span>
                <nav class="mt-2 mt-md-0">
                  <ul class="pagination mb-0">
                    <li class="page-item" th:classappend="${page.hasPrevious} ? '' : 'disabled'">
                      <a class="page-link" th:href="@{/admin/orders(page=${page.number - 1})}">Previous</a>
                    </li>
                    <li th:each="i : ${#numbers.sequence(1, page.totalPages)}" class="page-item"
                      th:classappend="${page.number == i} ? 'active'">
                      <a class="page-link" th:href="@{/admin/orders(page=${i})}" th:text="${i}">1</a>
                    </li>
                    <li class="page-item" th:classappend="${page.hasNext} ? '' : 'disabled'">
                      <a class="page-link" th:href="@{/admin/orders(page=${page.number + 1})}">Next</a>
                    </li>
                  </ul>
                </nav>
              </div>

            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="../assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/libs/simplebar/dist/simplebar.min.js"></script>
  <script src="../assets/js/theme.min.js"></script>
</body>

</html>